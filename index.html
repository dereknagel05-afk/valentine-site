<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Jillie üíò</title>

  <!-- Pixel font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    :root{
      /* Beige game UI palette */
      --bg:#f7f0df;
      --bg2:#efe4cc;
      --ink:#2b241a;
      --muted:#5a4b38;
      --panel:#fff7e6;
      --panel2:#f1e1c2;
      --border:#b28a57;
      --borderDark:#7a5731;
      --pink:#ff4b88;
      --red:#ff4b4b;
      --green:#30c46c;
      --shadow: 0 18px 50px rgba(43,36,26,0.22);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      background:
        radial-gradient(900px 600px at 15% 15%, rgba(255,75,136,.10), transparent 62%),
        radial-gradient(900px 650px at 80% 30%, rgba(48,196,108,.10), transparent 62%),
        linear-gradient(180deg, var(--bg), var(--bg2));
      color: var(--ink);
      padding: 18px;
      overflow:hidden;
      font-family:"Press Start 2P", ui-monospace, Menlo, Monaco, Consolas, "Courier New", monospace;
    }

    /* Subtle floating pixel hearts */
    .hearts{
      position:fixed;
      inset:0;
      pointer-events:none;
      opacity:.22;
      overflow:hidden;
    }
    .heart{
      position:absolute;
      width:10px;
      height:10px;
      background: var(--pink);
      transform: rotate(45deg);
      image-rendering: pixelated;
      animation: floatUp linear forwards;
      filter: drop-shadow(0 2px 0 rgba(0,0,0,.06));
    }
    .heart:before, .heart:after{
      content:"";
      position:absolute;
      width:10px;height:10px;
      background: var(--pink);
    }
    .heart:before{ left:-6px; top:0; }
    .heart:after{ top:-6px; left:0; }
    @keyframes floatUp{
      to{ transform: translateY(-110vh) rotate(45deg); opacity:0; }
    }

    /* Main layout */
    .game{
      width:min(980px, 96vw);
      display:grid;
      grid-template-columns: 260px 1fr;
      gap: 16px;
      align-items:start;
    }
    @media (max-width: 820px){
      .game{ grid-template-columns: 1fr; }
    }

    /* Left panel */
    .side{
      background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.65));
      border: 4px solid var(--borderDark);
      box-shadow: var(--shadow);
      padding: 12px;
      position:relative;
    }
    .side:before{
      content:"";
      position:absolute; inset:6px;
      border: 2px solid rgba(122,87,49,.35);
      pointer-events:none;
    }

    .portrait{
      position:relative;
      aspect-ratio: 1 / 1;
      background: linear-gradient(180deg, var(--panel), var(--panel2));
      border: 4px solid var(--border);
      box-shadow: inset 0 0 0 3px rgba(255,255,255,.55);
      overflow:hidden;
    }
    .portrait img{
      position:absolute; inset:0;
      width:100%; height:100%;
      object-fit:cover;
      image-rendering: pixelated;
      filter: contrast(1.05) saturate(1.05);
      transition: opacity 800ms ease, transform 800ms ease;
    }
    #happy{ opacity:0; transform: scale(1.02); }
    #sad{ opacity:1; transform: scale(1.00); }

    .sideText{
      margin-top:10px;
      font-size:10px;
      line-height:1.9;
      color: var(--muted);
    }

    /* Characters row (simple) */
    .chars{
      display:flex;
      gap: 10px;
      align-items:center;
      justify-content:space-between;
      margin-top:12px;
      padding-top:12px;
      border-top:2px dashed rgba(122,87,49,.35);
    }
    .charCard{
      width: 48%;
      background: rgba(255,255,255,.6);
      border: 3px solid rgba(122,87,49,.45);
      padding: 8px;
      display:grid;
      gap: 6px;
      justify-items:center;
    }
    .charLabel{
      font-size:9px;
      color: var(--muted);
      text-align:center;
      line-height:1.6;
    }

    /* Right: dialogue box */
    .dialogue{
      background: linear-gradient(180deg, rgba(255,255,255,.88), rgba(255,255,255,.72));
      border: 4px solid var(--borderDark);
      box-shadow: var(--shadow);
      padding: 14px;
      position:relative;
    }
    .dialogue:before{
      content:"";
      position:absolute; inset:6px;
      border: 2px solid rgba(122,87,49,.35);
      pointer-events:none;
    }

    .topBar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      padding: 6px 6px 10px 6px;
    }
    .badge{
      font-size:10px;
      color: var(--muted);
      padding: 8px 10px;
      border: 2px solid rgba(122,87,49,.35);
      background: rgba(255,247,230,.8);
    }

    h1{
      margin: 8px 6px 10px 6px;
      font-size: clamp(14px, 2.3vw, 22px);
      line-height: 1.55;
      letter-spacing: .02em;
      color: var(--ink);
    }
    p{
      margin: 0 6px 12px 6px;
      font-size: clamp(10px, 1.6vw, 13px);
      line-height: 2.0;
      color: var(--muted);
      max-width: 64ch;
      white-space: pre-line;
    }

    .progress{
      margin: 10px 6px 12px 6px;
      height: 14px;
      border: 3px solid rgba(122,87,49,.45);
      background: rgba(255,247,230,.75);
      overflow:hidden;
      box-shadow: inset 0 0 0 2px rgba(255,255,255,.45);
    }
    .bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--pink), #ffb86b, #6fe7ff);
      transition: width 450ms ease;
    }

    .choices{
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
      padding: 0 6px 6px 6px;
    }
    button{
      font-family:inherit;
      cursor:pointer;
      font-size: 11px;
      padding: 12px 12px;
      border: 3px solid rgba(122,87,49,.55);
      background: rgba(255,247,230,.85);
      color: var(--ink);
      box-shadow: 0 6px 0 rgba(122,87,49,.20);
      transition: transform 120ms ease, background 200ms ease;
      user-select:none;
    }
    button:hover{ background: rgba(255,255,255,.90); }
    button:active{ transform: translateY(2px); box-shadow: 0 4px 0 rgba(122,87,49,.20); }

    /* Final arena */
    .final{
      margin: 10px 6px 6px 6px;
      padding: 12px;
      border: 3px solid rgba(122,87,49,.45);
      background: rgba(255,247,230,.70);
      display:none;
    }
    .arena{
      margin-top:10px;
      height: 120px;
      border: 3px dashed rgba(122,87,49,.45);
      background: rgba(255,255,255,.55);
      position:relative;
      overflow:hidden;
    }

    #yesBtn, #noBtn{
      position:absolute;
      will-change: transform;
      transition: transform 240ms ease;
    }

    #yesBtn{
      border-color: rgba(48,196,108,.65);
      background: rgba(48,196,108,.20);
    }
    #noBtn{
      border-color: rgba(255,75,75,.55);
      background: rgba(255,75,75,.18);
    }

    .cursorHint{
      font-size:10px;
      color: var(--muted);
      margin-top:10px;
      line-height:1.8;
    }

    /* Confetti (kept subtle) */
    .confetti{ position:fixed; inset:0; pointer-events:none; overflow:hidden; }
    .piece{
      position:absolute; top:-20px;
      width:10px; height:14px;
      opacity:.95;
      animation: fall linear forwards;
      border-radius: 2px;
    }
    @keyframes fall{
      to{ transform: translateY(110vh) rotate(720deg); }
    }

    /* SVG pixel art should look crisp */
    svg { image-rendering: pixelated; }
  </style>
</head>

<body>
  <div class="hearts" id="hearts"></div>

  <div class="game">
    <!-- LEFT PANEL -->
    <aside class="side">
      <div class="portrait" aria-label="portrait">
        <img id="sad" src="sad.jpg" alt="sad portrait">
        <img id="happy" src="happy.jpg" alt="happy portrait">
      </div>

      <div class="sideText" id="sideText">
        STATUS: missing Jillie‚Ä¶<br>
        MODE: long distance üíå<br>
        QUEST: make you smile (and maybe cry)
      </div>

      <div class="chars">
        <div class="charCard">
          <!-- Simple pixel dino SVG -->
          <svg width="86" height="86" viewBox="0 0 86 86" aria-label="dino">
            <rect width="86" height="86" fill="transparent"/>
            <!-- body -->
            <rect x="18" y="36" width="44" height="28" fill="#39b86b"/>
            <rect x="22" y="32" width="30" height="10" fill="#39b86b"/>
            <rect x="26" y="26" width="24" height="10" fill="#39b86b"/>
            <!-- belly -->
            <rect x="28" y="42" width="22" height="18" fill="#a6f0c2"/>
            <!-- eye -->
            <rect x="38" y="30" width="4" height="4" fill="#2b241a"/>
            <!-- spikes -->
            <rect x="24" y="24" width="6" height="4" fill="#ffd36a"/>
            <rect x="30" y="22" width="6" height="4" fill="#ffd36a"/>
            <rect x="36" y="20" width="6" height="4" fill="#ffd36a"/>
            <!-- heart -->
            <rect x="56" y="46" width="4" height="4" fill="#ff4b88"/>
            <rect x="60" y="46" width="4" height="4" fill="#ff4b88"/>
            <rect x="58" y="50" width="4" height="4" fill="#ff4b88"/>
            <!-- feet -->
            <rect x="26" y="64" width="10" height="6" fill="#2fa65f"/>
            <rect x="44" y="64" width="10" height="6" fill="#2fa65f"/>
          </svg>
          <div class="charLabel">DINO<br>‚ÄúTEAM YES‚Äù</div>
        </div>

        <div class="charCard">
          <!-- Simple pixel unicorn SVG -->
          <svg width="86" height="86" viewBox="0 0 86 86" aria-label="unicorn">
            <rect width="86" height="86" fill="transparent"/>
            <!-- body -->
            <rect x="22" y="40" width="40" height="22" fill="#ffffff"/>
            <rect x="26" y="34" width="22" height="10" fill="#ffffff"/>
            <!-- mane -->
            <rect x="44" y="34" width="10" height="8" fill="#ffb3d2"/>
            <rect x="48" y="40" width="10" height="10" fill="#ffb3d2"/>
            <!-- horn -->
            <rect x="40" y="24" width="6" height="10" fill="#ffd36a"/>
            <rect x="42" y="20" width="2" height="4" fill="#ffd36a"/>
            <!-- eye -->
            <rect x="34" y="38" width="4" height="4" fill="#2b241a"/>
            <!-- envelope -->
            <rect x="54" y="48" width="10" height="8" fill="#fff7e6"/>
            <rect x="54" y="48" width="10" height="2" fill="#b28a57"/>
            <rect x="54" y="54" width="10" height="2" fill="#b28a57"/>
            <!-- feet -->
            <rect x="28" y="62" width="8" height="8" fill="#d9d9d9"/>
            <rect x="46" y="62" width="8" height="8" fill="#d9d9d9"/>
          </svg>
          <div class="charLabel">UNICORN<br>‚ÄúI DELIVER LOVE‚Äù</div>
        </div>
      </div>
    </aside>

    <!-- RIGHT: DIALOGUE -->
    <section class="dialogue">
      <div class="topBar">
        <div class="badge" id="levelBadge">LEVEL 1 / 5</div>
        <div class="badge" id="hintBadge">press a button</div>
      </div>

      <h1 id="title">Jillie‚Ä¶ I have a quest for you üíò</h1>
      <p id="subtitle">A tiny game, for my favorite person.\n(You‚Äôll know when the final boss appears.)</p>

      <div class="progress"><div class="bar" id="bar"></div></div>

      <div class="choices" id="choices"></div>

      <div class="final" id="final">
        <h1 id="finalTitle" style="margin:0 0 10px 0;">FINAL BOSS üò≥</h1>
        <p id="finalText" style="margin:0;">Jillie, will you be my Valentine?</p>

        <div class="arena" id="arena">
          <button id="yesBtn">YES üíò</button>
          <button id="noBtn">NO‚Ä¶ üôÉ</button>
        </div>

        <div class="cursorHint" id="cursorHint">
          TIP: The heart cursor always finds the right answer.
        </div>
      </div>
    </section>
  </div>

  <div class="confetti" id="confetti"></div>

  <script>
    // ----------------- CUSTOMIZE TEXT HERE -----------------
    const herName = "Jillie";
    const years = 4;

    const yesMessage = [
      `Jillie‚Ä¶ you said YES üò≠üíò`,
      ``,
      `We‚Äôve been together ${years} years, and I still miss you like crazy.`,
      `Long distance doesn‚Äôt change what I know ‚Äî it just makes the wanting louder.`,
      ``,
      `I miss your ‚Äúbeing here.‚Äù`,
      `I miss the normal stuff: your voice in the room, the little pauses, the comfort.`,
      ``,
      `My favorite memory is sunrise with you ‚Äî`,
      `that quiet moment where everything feels soft and possible.`,
      `That‚Äôs what you feel like to me.`,
      ``,
      `So here‚Äôs my Valentine promise:`,
      `Until the distance is gone, I‚Äôm still choosing you every day.`,
      `And I‚Äôm saving all my hugs for the next sunrise.`,
      ``,
      `Happy Valentine‚Äôs Day, my love. üíû`
    ].join("\n");

    const steps = [
      {
        title: `${herName}, welcome to our little love game üíå`,
        subtitle: `Press START by choosing the vibe that feels most like us.`,
        options: [
          { text: "soft & safe ü´∂", next: 1 },
          { text: "best friends + forever ü§ù", next: 1 },
          { text: "down bad (respectfully) üò≠", next: 1 },
        ]
      },
      {
        title: "Checkpoint: Long Distance üìç",
        subtitle: `What do you want more of right now?`,
        options: [
          { text: "more calls where we don‚Äôt rush ‚è≥", next: 2 },
          { text: "more visits (so I can hug you) üß∏", next: 2 },
          { text: "more plans for our future üóìÔ∏è", next: 2 },
        ]
      },
      {
        title: "Memory Quest üåÖ",
        subtitle: `Which moment feels like ‚Äúhome‚Äù with me?`,
        options: [
          { text: "watching the sunrise together", next: 3 },
          { text: "late-night talks", next: 3 },
          { text: "laughing at something dumb", next: 3 },
        ]
      },
      {
        title: "Bonus Round üíó",
        subtitle: `Pick the message I wish I could teleport to you right now:`,
        options: [
          { text: "‚ÄúI miss you. Come here.‚Äù", next: 4 },
          { text: "‚ÄúI‚Äôm proud of us.‚Äù", next: 4 },
          { text: "‚ÄúI‚Äôm counting days.‚Äù", next: 4 },
        ]
      },
      {
        title: "Unlock Final Boss üò≥",
        subtitle: `Okay‚Ä¶ I‚Äôm nervous. Are you ready?`,
        options: [
          { text: "I‚Äôm ready üíò", next: "final" },
          { text: "Say it üò≠", next: "final" },
          { text: "If I cry it‚Äôs your fault", next: "final" },
        ]
      }
    ];

    // ----------------- SOUND (simple chiptune beeps) -----------------
    const audio = {
      ctx: null,
      init(){
        if (!this.ctx) this.ctx = new (window.AudioContext || window.webkitAudioContext)();
      },
      beep(freq=600, duration=0.06, type="square", vol=0.06){
        this.init();
        const t = this.ctx.currentTime;
        const o = this.ctx.createOscillator();
        const g = this.ctx.createGain();
        o.type = type;
        o.frequency.setValueAtTime(freq, t);
        g.gain.setValueAtTime(vol, t);
        g.gain.exponentialRampToValueAtTime(0.0001, t + duration);
        o.connect(g); g.connect(this.ctx.destination);
        o.start(t); o.stop(t + duration);
      },
      click(){ this.beep(740, 0.05, "square", 0.05); },
      dodge(){ this.beep(220, 0.07, "square", 0.06); setTimeout(()=>this.beep(196, 0.07, "square", 0.06), 80); },
      win(){
        const notes = [784, 988, 1175, 1568];
        notes.forEach((n,i)=>setTimeout(()=>this.beep(n, 0.09, "square", 0.06), i*90));
      }
    };

    // ----------------- UI HOOKS -----------------
    const heartsEl = document.getElementById("hearts");
    const confettiEl = document.getElementById("confetti");

    const levelBadge = document.getElementById("levelBadge");
    const hintBadge = document.getElementById("hintBadge");

    const titleEl = document.getElementById("title");
    const subtitleEl = document.getElementById("subtitle");
    const choicesEl = document.getElementById("choices");
    const barEl = document.getElementById("bar");

    const finalEl = document.getElementById("final");
    const finalTitleEl = document.getElementById("finalTitle");
    const finalTextEl = document.getElementById("finalText");
    const cursorHint = document.getElementById("cursorHint");

    const arena = document.getElementById("arena");
    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");

    const sadImg = document.getElementById("sad");
    const happyImg = document.getElementById("happy");

    let stepIndex = 0;

    // Smooth movement helper (transform-based)
    function moveButton(btn, x, y){
      btn.style.transform = `translate(${x}px, ${y}px)`;
    }

    // Place buttons initially (stable)
    let yesPos = {x: 14, y: 14};
    let noPos = {x: 190, y: 64};

    function layoutButtons(){
      // Use arena size to position with padding
      const pad = 10;
      const w = arena.clientWidth;
      const h = arena.clientHeight;

      const yRect = yesBtn.getBoundingClientRect();
      const nRect = noBtn.getBoundingClientRect();

      // YES top-left
      yesPos = { x: pad, y: pad };
      moveButton(yesBtn, yesPos.x, yesPos.y);

      // NO bottom-right (initial)
      const nx = Math.max(pad, w - (nRect.width || 120) - pad);
      const ny = Math.max(pad, h - (nRect.height || 40) - pad);
      noPos = { x: nx, y: ny };
      moveButton(noBtn, noPos.x, noPos.y);
    }

    // Debounced dodge to avoid ‚Äúglitchy‚Äù
    let lastDodge = 0;
    let noCount = 0;

    function dodgeNo(){
      const now = Date.now();
      if (now - lastDodge < 170) return;
      lastDodge = now;

      audio.dodge();
      noCount++;

      const pad = 10;
      const w = arena.clientWidth;
      const h = arena.clientHeight;
      const rect = noBtn.getBoundingClientRect();

      const bw = rect.width || 120;
      const bh = rect.height || 40;

      const maxX = Math.max(pad, w - bw - pad);
      const maxY = Math.max(pad, h - bh - pad);

      // pick a new spot that isn't too close to YES
      let x, y;
      for (let tries=0; tries<8; tries++){
        x = pad + Math.floor(Math.random() * (maxX - pad + 1));
        y = pad + Math.floor(Math.random() * (maxY - pad + 1));
        const dx = x - yesPos.x;
        const dy = y - yesPos.y;
        if ((dx*dx + dy*dy) > 9000) break; // keep distance
      }

      noPos = {x, y};
      moveButton(noBtn, noPos.x, noPos.y);

      const phrases = [
        "hmmm‚Ä¶",
        "be serious üò≠",
        "that‚Äôs not allowed",
        "try again",
        "Jillie pls",
        "you know it‚Äôs YES üíò"
      ];
      hintBadge.textContent = phrases[Math.min(noCount, phrases.length-1)];
    }

    // Steps
    function setStep(i){
      stepIndex = i;
      const s = steps[i];
      levelBadge.textContent = `LEVEL ${i+1} / ${steps.length}`;
      hintBadge.textContent = "press a button";

      titleEl.textContent = s.title;
      subtitleEl.textContent = s.subtitle;

      barEl.style.width = Math.round((i / steps.length) * 100) + "%";

      choicesEl.innerHTML = "";
      s.options.forEach(opt=>{
        const b = document.createElement("button");
        b.textContent = opt.text;
        b.addEventListener("click", ()=>{
          audio.click();
          if(opt.next === "final") showFinal();
          else setStep(opt.next);
        });
        choicesEl.appendChild(b);
      });
    }

    function showFinal(){
      barEl.style.width = "100%";
      hintBadge.textContent = "final boss";

      finalEl.style.display = "block";
      finalTitleEl.textContent = "FINAL BOSS üò≥";
      finalTextEl.textContent = `${herName}, will you be my Valentine?`;
      cursorHint.textContent = "TIP: Use your heart cursor.";

      // layout after visible
      requestAnimationFrame(()=>{
        layoutButtons();
      });
    }

    // YES click: flip portrait, big message, confetti + hearts + win sound
    yesBtn.addEventListener("click", ()=>{
      audio.win();

      sadImg.style.opacity = "0";
      happyImg.style.opacity = "1";
      happyImg.style.transform = "scale(1.00)";

      hintBadge.textContent = "YOU DID IT üíò";
      finalTitleEl.textContent = "I MISS YOU üò≠üíû";
      finalTextEl.textContent = yesMessage;

      // Remove NO button after yes
      noBtn.style.display = "none";
      yesBtn.textContent = "come here ü´Ç";

      launchConfetti(120);
      burstHearts(24);
    });

    // NO behavior
    noBtn.addEventListener("mouseenter", dodgeNo);
    noBtn.addEventListener("click", dodgeNo);

    // Hearts background
    function spawnHeart(){
      const h = document.createElement("div");
      h.className = "heart";
      h.style.left = (5 + Math.random()*90) + "vw";
      h.style.bottom = (-20) + "px";
      h.style.animationDuration = (3.6 + Math.random()*3.2) + "s";
      h.style.opacity = (0.12 + Math.random()*0.25);
      heartsEl.appendChild(h);
      setTimeout(()=>h.remove(), 8000);
    }
    setInterval(()=>spawnHeart(), 750);

    function burstHearts(n){
      for(let i=0;i<n;i++){
        setTimeout(spawnHeart, i*35);
      }
    }

    // Confetti
    function launchConfetti(count){
      confettiEl.innerHTML = "";
      const colors = ["#ff4b88","#ffcf6a","#6fe7ff","#30c46c","#ffffff"];
      for(let i=0;i<count;i++){
        const d = document.createElement("div");
        d.className = "piece";
        d.style.left = (Math.random()*100) + "vw";
        d.style.background = colors[Math.floor(Math.random()*colors.length)];
        d.style.width = (6 + Math.random()*9) + "px";
        d.style.height = (8 + Math.random()*16) + "px";
        d.style.animationDuration = (2.2 + Math.random()*2.6) + "s";
        d.style.animationDelay = (Math.random()*0.25) + "s";
        confettiEl.appendChild(d);
      }
      setTimeout(()=>confettiEl.innerHTML="", 6000);
    }

    // Responsive relayout
    window.addEventListener("resize", ()=>{
      if (finalEl.style.display !== "none") layoutButtons();
    });

    // Init
    setStep(0);
  </script>
</body>
</html>
